/* CDP-Template 2015-06-09 */
!function(a,b){"function"==typeof define&&define.amd?define(["cdp.ui.jqm"],function(){return b(a.CDP||(a.CDP={}))}):b(a.CDP||(a.CDP={}))}(this,function(a){a.UI=a.UI||{};var a;!function(a){var b;!function(a){var b=function(){function a(){this._settings=null,this._$container=null,this._resizeTimerId=0,this._hiddenTimerId=0,this._profile=null,this._inPaging=!1}return a.prototype.init=function(b,c,d){var e=this;return!b||!c||0>=c?(console.log("error. invalid arg"),!1):(this._settings=$.extend({},a._defaultOptions,d),this._settings.containerId=b,this._settings.count=c,"horizontal"!==this._settings.orientation?(console.log("error. unsupported orientation. orientation: "+this._settings.orientation),!1):(this._$container&&this._$container.children().remove(),$(window).resize(function(){clearTimeout(e._resizeTimerId),e._resizeTimerId=setTimeout(function(){var a=e._profile.lastEnsureVisbleElementIndex;e.clearPage(),e.setupPage(),e._settings.ensureVisibleOnResize&&e.setPageVisibility(a)},200)}),this.prepareElements(),this.setupPage()))},a.prototype.valid=function(){return!!this._$container},a.prototype.pageNext=function(){if(!this.valid())return void console.log("error. not to be initialized.");var a=this._$container.scrollLeft()+this._profile.pageSize;this.scroll(a,!0)},a.prototype.pagePrevious=function(){if(!this.valid())return void console.log("error. not to be initialized.");var a=this._$container.scrollLeft()-this._profile.pageSize;this.scroll(a,!0)},a.prototype.canPageNext=function(){if(!this.valid())return!1;var a=this._$container.scrollLeft()+$(window).width();return this._profile.scrollMapSize<=$(window).width()||this._profile.scrollMapSize<=a?!1:!0},a.prototype.canPagePrevious=function(){if(!this.valid())return!1;var a=this._$container.scrollLeft();return 0===a?!1:!0},a.prototype.getElementCount=function(){return this.valid()?this._settings.count:0},a.prototype.getElement=function(b){return this.valid()?0>b||this._settings.count<=b?(console.log("error. invalid index. : "+b),null):this._$container.find("div["+a.DATA_ELEMENT_INDEX+"='"+b+"']"):null},a.prototype.setFocus=function(a,b){void 0===b&&(b=!0),this.valid()&&this._settings.focusClass&&(b&&this._$container.find("."+this._settings.elementClass).removeClass(this._settings.focusClass),this.getElement(a).addClass(this._settings.focusClass))},a.prototype.ensureVisible=function(a){if(this.valid()){if(0>a||this._settings.count<=a)return console.log("error. invalid index. : "+a),null;var b=this._profile.elementWidth*a,c=b-this._profile.ensureBase;this.scroll(c,!1,a)}},a.prototype.setElementStatus=function(b,c){if(this.valid()){var d=this._$container.find("div["+a.DATA_ELEMENT_INDEX+"='"+b+"']");c?d.attr(a.DATA_ELEMENT_READY,"true"):d.parent().attr(a.DATA_PAGE_READY,"false")}},a.prototype.setSettings=function(a){this._settings=$.extend({},this._settings,a)},a.prototype.prepareElements=function(){var a=this;this._$container=$("#"+this._settings.containerId);for(var b=0;b<this._settings.count;b++)this._$container.append(this.createElement(this._settings.elementClass,b));this._$container.scroll(function(){a._inPaging||(a.setPageVisibilityByPosition(a._$container.scrollLeft()),"function"==typeof a._settings.onScrollEnd&&a._settings.onScrollEnd(a._$container.scrollTop(),a._$container.scrollLeft()))})},a.prototype.createElement=function(b,c){var d=this,e="<div class='"+b+"' "+a.DATA_ELEMENT_INDEX+"='"+c+"' "+a.DATA_ELEMENT_READY+"='false'></div>",f=$(e);return"function"==typeof this._settings.onClickElement&&f.on("click",function(){d._settings.onClickElement(c,f)}),"function"==typeof this._settings.onTouchStartElement&&f.on("touchstart MSPointerDown",function(){d._settings.onTouchStartElement(c,f)}),"function"==typeof this._settings.onTouchEndElement&&f.on("touchend MSPointerUp",function(){d._settings.onTouchEndElement(c,f)}),f},a.prototype.createPage=function(b){var c="<div class='"+a.PAGE_CLASS_NAME+"' "+a.DATA_PAGE_INDEX+"='"+b+"' "+a.DATA_PAGE_READY+"='false'></div>",d=$(c),e={overflow:"hidden",whiteSpace:"nowrap",display:"inline-block",visibility:"hidden"};return d.css(e),d},a.prototype.clearPage=function(){var b=this._$container.find(a.PAGE_CLASS_SELECTOR);b.children().unwrap()},a.prototype.setupPage=function(){var a=this._$container.parent().width()-(parseInt(this._$container.css("margin-left"),10)+parseInt(this._$container.css("margin-right"),10)),b=this._$container.find("."+this._settings.elementClass),c=b.first().width()+parseInt(b.first().css("margin-left"),10)+parseInt(b.first().css("margin-right"),10)+parseInt(b.first().css("padding-left"),10)+parseInt(b.first().css("padding-right"),10)+parseInt(b.first().css("border-left-width"),10)+parseInt(b.first().css("border-right-width"),10);if(0>=a||0>=c)return console.log("error. invalid width."),!1;for(var d=c*this._settings.count,e=Math.ceil(d/a),f=Math.floor(a/c);e*f<this._settings.count;)e++;var g=0,h=0,i=0;for(g=0;e>g;g++){h=g*f,i=h+f,this._settings.count<i&&(i=this._settings.count);var j=b.slice(h,i);j.wrapAll(this.createPage(g))}return this._$container.width(a),this._profile={},this._profile.scrollMapSize=d,this._profile.elementWidth=c,this._profile.pageNum=e,this._profile.pageElementNum=f,this._profile.pageSize=f*c,this._profile.ensureBase=Math.floor(a*this._settings.ensureBaseRacio/c)*c,this._profile.lastEnsureVisbleElementIndex=0,!0},a.prototype.scroll=function(a,b,c){b?this.animateScroll(a):(this._$container.scrollLeft(a),"function"==typeof this._settings.onScrollEnd&&this._settings.onScrollEnd(this._$container.scrollTop(),this._$container.scrollLeft())),null!=c?this.setPageVisibility(c):this.setPageVisibilityByPosition(a)},a.prototype.animateScroll=function(a){var b=this;this._inPaging=!0;var c=function(){b._inPaging=!1,"function"==typeof b._settings.onScrollEnd&&b._settings.onScrollEnd(b._$container.scrollTop(),b._$container.scrollLeft())};this._$container.animate({scrollLeft:a},{speed:this._settings.scrollSpeed,easing:"linear",complete:c})},a.prototype.setPageVisibility=function(b){var c=this;0>b&&(b=0);var d=this._$container.find("div["+a.DATA_ELEMENT_INDEX+"='"+b+"']").parent(),e=parseInt(d.attr(a.DATA_PAGE_INDEX),10),f=null,g=null,h=0,i=0;this._profile.lastEnsureVisbleElementIndex=b;var j=null,k=null;if(e>0)for(i=0,h=e-1;i<this._settings.preloadCount&&!(0>h);i++,h--)j=h,f=this._$container.find("div["+a.DATA_PAGE_INDEX+"='"+h+"']"),f.css("visibility","visible"),this.preparePageData(f);if(d.css("visibility","visible"),this.preparePageData(d),e<this._profile.pageNum-1)for(i=0,h=e+1;i<this._settings.preloadCount&&!(this._profile.pageNum-1<h);i++,h++)k=h+1,g=this._$container.find("div["+a.DATA_PAGE_INDEX+"='"+h+"']"),g.css("visibility","visible"),this.preparePageData(g);("number"==typeof j||"number"==typeof k)&&(clearTimeout(this._hiddenTimerId),this._hiddenTimerId=setTimeout(function(){"number"==typeof j&&c._$container.children().slice(0,j).css("visibility","hidden"),"number"==typeof k&&c._$container.children().slice(k,c._profile.pageNum).css("visibility","hidden")},this._settings.scrollSpeed))},a.prototype.setPageVisibilityByPosition=function(a){var b=Math.floor(a/this._profile.elementWidth);this.setPageVisibility(b)},a.prototype.preparePageData=function(b){var c=this,d=b.attr(a.DATA_PAGE_READY);if("false"===d&&"function"==typeof this._settings.onSetElement){b.attr(a.DATA_PAGE_READY,"true");var e=b.find("div["+a.DATA_ELEMENT_READY+"='false']");e.each(function(b,d){var e=parseInt($(d).attr(a.DATA_ELEMENT_INDEX),10);c._settings.onSetElement(e,$(d))})}},a._defaultOptions={orientation:"horizontal",elementClass:"cdp-smooth-page-element",focusClass:null,preloadCount:1,scrollSpeed:250,ensureBaseRacio:.25,ensureVisibleOnResize:!0,onSetElement:null,onClickElement:null,onTouchStartElement:null,onTouchEndElement:null,onScrollEnd:null},a.PAGE_CLASS_NAME="cdp-smooth-page",a.PAGE_CLASS_SELECTOR=".cdp-smooth-page",a.DATA_PAGE_READY="data-page-ready",a.DATA_PAGE_INDEX="data-page-index",a.DATA_ELEMENT_INDEX="data-element-index",a.DATA_ELEMENT_READY="data-element-ready",a}();a.SmoothScroll=b}(b=a.UI||(a.UI={}))}(a||(a={}));var a;!function(a){var b;!function(a){var b=function(){function a(){}return a.show=function(b){void 0===b&&(b="cdp-device-console"),this.hide(),a.s_console||(a.s_console=window.console),a.s_instance||(a.s_instance=new a),window.console=a.s_instance,a.s_$display?a.s_$display.css("visibility","visible"):(a.s_$display=$("<div id='"+b+"'></div>"),a.s_$display.appendTo($(document.body)),$(document).on("pagebeforeshow",function(){a.visible()&&(a.s_$display.appendTo($(document.body)),a.s_$display.scrollTop(a.s_$display[0].scrollHeight))}))},a.hide=function(){a.s_console&&(window.console=a.s_console),a.s_$display&&(a.s_$display.css("visibility","hidden"),a.clearMessage()),a.s_instance=null},a.toggle=function(b){void 0===b&&(b="pmo-device-console"),a.visible()?a.hide():a.show(b)},a.destroy=function(){a.hide(),a.s_$display&&(a.s_$display.remove(),a.s_$display=null)},a.visible=function(){return null!=a.s_instance},a.setLineNumber=function(b){a.s_line=b},a.output=function(b,c){setTimeout(function(){if(a.s_$display){a.s_line<=a.s_$display.children().length&&a.s_$display.children().first().remove();var d=null!=c?"<p class='"+c+"'>":"<p>";a.s_$display.append(d+b+"</p>"),setTimeout(function(){a.s_$display.scrollTop(a.s_$display[0].scrollHeight)},1)}},1)},a.clearMessage=function(){a.s_$display&&a.s_$display.children().remove()},a.prototype.count=function(b){a.s_console&&a.s_console.count(b)},a.prototype.groupEnd=function(){a.s_console&&a.s_console.groupEnd()},a.prototype.time=function(b){a.s_console&&a.s_console.time(b)},a.prototype.timeEnd=function(b){a.s_console&&a.s_console.timeEnd(b)},a.prototype.trace=function(){a.s_console&&a.s_console.trace()},a.prototype.group=function(b){a.s_console&&a.s_console.group(b)},a.prototype.dirxml=function(b){a.s_console&&a.s_console.dirxml(b)},a.prototype.debug=function(b){for(var c=[],d=1;d<arguments.length;d++)c[d-1]=arguments[d];a.s_console&&(0<c.length?a.s_console.debug(b,c):a.s_console.debug(b)),a.output("[debug]"+b,"debug")},a.prototype.groupCollapsed=function(b){a.s_console&&a.s_console.groupCollapsed(b)},a.prototype.select=function(b){a.s_console&&a.s_console.select(b)},a.prototype.info=function(b){for(var c=[],d=1;d<arguments.length;d++)c[d-1]=arguments[d];a.s_console&&(0<c.length?a.s_console.info(b,c):a.s_console.info(b)),a.output("[info]"+b,"info")},a.prototype.profile=function(b){a.s_console&&a.s_console.profile(b)},a.prototype.assert=function(b,c){for(var d=[],e=2;e<arguments.length;e++)d[e-2]=arguments[e];a.s_console&&(0<d.length?a.s_console.assert(b,c,d):a.s_console.assert(b,c)),a.output("[assert]"+c,"assert")},a.prototype.msIsIndependentlyComposed=function(b){return a.s_console?a.s_console.msIsIndependentlyComposed(b):!1},a.prototype.clear=function(){a.s_console&&a.s_console.clear()},a.prototype.dir=function(b){for(var c=[],d=1;d<arguments.length;d++)c[d-1]=arguments[d];a.s_console&&(0<c.length?a.s_console.dir(b,c):a.s_console.dir(b))},a.prototype.warn=function(b){for(var c=[],d=1;d<arguments.length;d++)c[d-1]=arguments[d];a.s_console&&(0<c.length?a.s_console.warn(b,c):a.s_console.warn(b)),a.output("[warn]"+b,"warn")},a.prototype.error=function(b){for(var c=[],d=1;d<arguments.length;d++)c[d-1]=arguments[d];a.s_console&&(0<c.length?a.s_console.error(b,c):a.s_console.error(b)),a.output("[error]"+b,"error")},a.prototype.log=function(b){for(var c=[],d=1;d<arguments.length;d++)c[d-1]=arguments[d];a.s_console&&(0<c.length?a.s_console.log(b,c):a.s_console.log(b)),a.output(b)},a.prototype.profileEnd=function(){a.s_console&&a.s_console.profileEnd()},a.s_console=null,a.s_instance=null,a.s_$display=null,a.s_line=100,a}();a.DeviceConsole=b}(b=a.UI||(a.UI={}))}(a||(a={}));var a,b=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};return function(a){var c;!function(a){var c,d="[CDP.UI.PageTabListView] ";!function(a){a.SCROLL_MAP_CLASS="listview-scroll-map",a.SCROLL_MAP_SELECTOR="."+a.SCROLL_MAP_CLASS,a.FLIPSNAP_CLASS="flipsnap",a.FLIPSNAP_SELECTOR="."+a.FLIPSNAP_CLASS,a.FRIPSNAP_REFRESH_COEFF=1}(c||(c={}));var e=function(e){function f(b,c,d){var f=this;e.call(this,b,c,$.extend({},{showNativeScrollBar:!0},d)),this._listviews=[],this._needRebuild=[],this._activeTabIndex=0,this._flipsnap=null,this._flipEndEventHandler=null,this._flipMoveEventHandler=null,this._refreshTimerId=null,this._$contentsHolder=null;for(var g=0,h=d.tabCount;h>g;g++)this._listviews.push(new a.ScrollManager(d)),this._needRebuild.push(!1);this._flipEndEventHandler=function(a){var b=a.originalEvent;b.moved&&f.onFlipTabChanged(b.newPoint)},this._flipMoveEventHandler=function(a){var b=a.originalEvent;-1===b.direction&&0===f._activeTabIndex||1===b.direction&&f._activeTabIndex===f._listviews.length-1?(a.preventDefault(),f._flipsnap.moveToPoint(b.newPoint)):f.preprocess()}}return b(f,e),f.prototype.onOrientationChanged=function(){var a=this;this._listviews.forEach(function(b){b.setBaseHeight(a.getPageBaseHeight())}),null!=this._refreshTimerId&&clearTimeout(this._refreshTimerId),this._flipsnap&&!function(){var b=function(){a._flipsnap&&a._flipsnap.maxPoint!==a._listviews.length?(a._flipsnap.refresh(),a._refreshTimerId=setTimeout(b,a.getListViewOptions().scrollMapRefreshInterval)):a._refreshTimerId=null};a._flipsnap.refresh(),a._refreshTimerId=setTimeout(b,a.getListViewOptions().scrollMapRefreshInterval)}()},f.prototype.onBeforeRouteChange=function(){return this.resetFlipsnapCondition(),this._listviews.forEach(function(a){a.destroy()}),this._$contentsHolder=null,e.prototype.onBeforeRouteChange.call(this)},f.prototype.onPageBeforeShow=function(a,b){var f=this;e.prototype.onPageBeforeShow.call(this,a,b);var g=this.$page.find(c.SCROLL_MAP_SELECTOR);g.length===this._listviews.length?(this._listviews.forEach(function(a,b){a.initialize($(g[b]),f.getPageBaseHeight())}),this._$contentsHolder=this.$page.find(c.FLIPSNAP_SELECTOR).parent()):console.error(d+"data size miss match. [$maps:"+g.length+"][tabs:"+this._listviews.length+"]")},f.prototype.onPageShow=function(a,b){e.prototype.onPageShow.call(this,a,b),this.setFlipsnapCondition();for(var c=0,d=this._needRebuild.length;d>c;c++)this._needRebuild[c]&&this.rebuild(c),this._needRebuild[c]=!1},f.prototype.getActiveTabIndex=function(){return this._activeTabIndex},f.prototype.setActiveTab=function(a,b,d){var e=this;return d||this._activeTabIndex!==a&&this.validTab(a)?(this.preprocess(),this._activeTabIndex=a,this._flipsnap.moveToPoint(this._activeTabIndex,b),b=b||parseInt(this._flipsnap.transitionDuration,10),setTimeout(function(){e.postprocess(),e.onTabChanged(e._activeTabIndex)},b*c.FRIPSNAP_REFRESH_COEFF),!0):!1},f.prototype.onFlipTabChanged=function(a){this.setActiveTab(a)},f.prototype.onTabChanged=function(){},f.prototype.resetTabPosition=function(){this._listviews.forEach(function(a){a.scrollTo(0,!1,0),a.refresh()}),this.setActiveTab(0,0,!0)},f.prototype.isInitialized=function(){return this._activeview.isInitialized()},f.prototype.addItem=function(b,c,d,e,f){var g=this;this._targets(f,!0).forEach(function(f){f._addLine(new a.LineProfile(f,Math.floor(b),c,$.extend({},d,{owner:g})),e)})},f.prototype.removeItem=function(a,b,c,d){this._targets(d,!0).forEach(function(d){d.removeItem(a,b,c)})},f.prototype.getItemInfo=function(a,b){var c;return this._targets(b,!0).forEach(function(b){c=b.getItemInfo(a)}),c},f.prototype.refresh=function(a){this._targets(a,!0).forEach(function(a){a.refresh()})},f.prototype.update=function(a){this._targets(a,!0).forEach(function(a){a.update()}),this._$contentsHolder.height(this._activeview.getScrollMapHeight())},f.prototype.rebuild=function(a){this._targets(a,!0).forEach(function(a){a.rebuild()}),this._$contentsHolder.height(this._activeview.getScrollMapHeight())},f.prototype.release=function(a){this._targets(a,!0).forEach(function(a){a.release()})},f.prototype.backup=function(a,b){var c=!0;return this._targets(b,!1).forEach(function(b){var d=b.backup(a);d||(c=!1)}),c},f.prototype.restore=function(a,b,c){var d=this;void 0===b&&(b=!1);var e=!0,f=function(c,f){var h=d._listviews[g].restore(a,b);h?d._needRebuild[g]=f:e=!1};if(null==c)for(var g=0,h=this._listviews.length;h>g;g++)f(g,b);else this.validTab(c)?f(c,b):e=!1;return e},f.prototype.hasBackup=function(a,b){var c=!1;return this._targets(b,!1).forEach(function(b){var d=b.hasBackup(a);d&&(c=!0)}),c},f.prototype.clearBackup=function(a,b){var c=!0;return this._targets(b,!1).forEach(function(b){var d=b.clearBackup(a);d||(c=!1)}),c},Object.defineProperty(f.prototype,"backupData",{get:function(){return this._activeview.backupData},enumerable:!0,configurable:!0}),f.prototype.getBackupData=function(a){var b;return this._targets(a,!0).forEach(function(a){b=a.backupData}),b},f.prototype.setScrollHandler=function(a,b){this._activeview.setScrollHandler(a,b)},f.prototype.setScrollStopHandler=function(a,b){this._activeview.setScrollStopHandler(a,b)},f.prototype.getScrollPos=function(){return this._activeview.getScrollPos()},f.prototype.getScrollPosMax=function(){return this._activeview.getScrollPosMax()},f.prototype.scrollTo=function(a,b,c){this._activeview.scrollTo(a,b,c)},f.prototype.ensureVisible=function(a,b){this._activeview.ensureVisible(a,b)},f.prototype.getScrollMapHeight=function(){return this._activeview.getScrollMapHeight()},f.prototype.updateScrollMapHeight=function(a){this._activeview.updateScrollMapHeight(a)},f.prototype.updateProfiles=function(a){this._activeview.updateProfiles(a)},f.prototype.getScrollMapElement=function(){return this._activeview.getScrollMapElement()},f.prototype.findRecycleElements=function(){return this._activeview.findRecycleElements()},f.prototype.getListViewOptions=function(){return this._activeview.getListViewOptions()},f.prototype.setFlipsnapCondition=function(){this._flipsnap=Flipsnap(c.FLIPSNAP_SELECTOR,{}),$(this._flipsnap.element).on("fstouchend",_.bind(this._flipEndEventHandler,this)),$(this._flipsnap.element).on("fstouchmove",_.bind(this._flipMoveEventHandler,this)),this.setActiveTab(this._activeTabIndex,0,!0)},f.prototype.resetFlipsnapCondition=function(){$(this._flipsnap.element).off("fstouchmove",_.bind(this._flipMoveEventHandler,this)),$(this._flipsnap.element).off("fstouchend",_.bind(this._flipEndEventHandler,this)),this._flipsnap=null},f.prototype.preprocess=function(){var a=this;this._listviews.forEach(function(b,c){c!==a._activeTabIndex&&b.treatScrollPosition()})},f.prototype.postprocess=function(){var a=this;this._$contentsHolder.height(this._activeview.getScrollMapHeight()),this._listviews.forEach(function(b,c){b.setActiveState(c===a._activeTabIndex?!0:!1)})},f.prototype.validTab=function(a){return a>=0&&a<this._listviews.length?!0:(console.error(d+"invalid tab index. index: "+a),!1)},f.prototype._targets=function(a,b){return null==a?b?[this._activeview]:this._listviews:this.validTab(a)?[this._listviews[a]]:[]},Object.defineProperty(f.prototype,"_activeview",{get:function(){return this._listviews[this._activeTabIndex]},enumerable:!0,configurable:!0}),f.prototype.getPageBaseHeight=function(){return $(window).height()-parseInt(this.$page.css("padding-top"),10)},f}(a.PageView);a.PageTabListView=e}(c=a.UI||(a.UI={}))}(a||(a={})),a.UI});